<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connect MetaMask</title>
    <!-- load Ethers.js -->
    <script src="https://unpkg.com/ethers@5.7.0/dist/ethers.umd.min.js"></script>
    <!-- 'https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.0/ethers.umd.min.js' -->
</head>
<body>
    <div class="container">
        <h1>Connect MetaMask</h1>        
        <button id="connectButton">Connect</button>
        <button id="disconnectButton" class="disconnect-btn" style="display:none;">Disconnect</button>
        <div id="walletInfo"></div>
    </div>
    <script>
        initApp();
        async function initApp() {
            console.log('connectButton is pressed');
            const connectButton = document.getElementById('connectButton');
            connectButton.addEventListener('click', async () => {
                try {
                    if (!window.ethereum) { // check if ethers exists
                        alert('Please install MetaMask!');
                        return;
                    }
                    const provider = new ethers.providers.Web3Provider(window.ethereum);
                    // send request for accounts
                    const accounts = await provider.send("eth_requestAccounts", []);
                    console.log("found", accounts.length, "accounts")
                    accounts.array.forEach((account, index) => {console.log(account)});
                    // if (accounts.length === 0) {
                    // throw new Error('not found any account');
                // }
                } catch (error) {
                    console.error('Connection error:', error);
                }
            });
        }
    </script>
</body>
</html>
